services:
  qdrant:
    image: qdrant/qdrant
    ports:
      - "6333:6333"
    networks:
      - rag_net

  ingestor:
    build: ./ingestor-service
    environment:
      - QDRANT_URL=http://qdrant:6333
      - OPENAI_API_KEY=${OPENAI_API_KEY}
    expose:
      - "8000"
    depends_on:
      - qdrant
    networks:
      - rag_net

  query:
    build: ./query-service
    environment:
      - QDRANT_URL=http://qdrant:6333
      - OPENAI_API_KEY=${OPENAI_API_KEY}
    expose:
      - "8000"
    depends_on:
      - qdrant
    networks:
      - rag_net

  ui:
    build: ./rag-ui
    ports:
      - "3000:80"
    depends_on:
      - ingestor
      - query
    networks:
      - rag_net

networks:
  rag_net: {}
